<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>cookie 你咋还没整明白？ | dale&#39;s blog</title>
    <meta name="description" content="">
    <meta http-equiv="cache-control" content="no-cache, no-store, must-revalidate">
  <meta http-equiv="pragma" content="no-cache">
  <meta http-equiv="expires" content="0">
  <link rel="icon" href="/Blog-VuePress/favicon.ico">
    
    <link rel="preload" href="/Blog-VuePress/assets/css/0.styles.85a63941.css" as="style"><link rel="preload" href="/Blog-VuePress/assets/js/app.5bdb8c72.js" as="script"><link rel="preload" href="/Blog-VuePress/assets/js/2.36c4ad05.js" as="script"><link rel="preload" href="/Blog-VuePress/assets/js/19.9bdddd99.js" as="script"><link rel="prefetch" href="/Blog-VuePress/assets/js/10.0e85af3c.js"><link rel="prefetch" href="/Blog-VuePress/assets/js/11.44768ff5.js"><link rel="prefetch" href="/Blog-VuePress/assets/js/12.cf4e8c20.js"><link rel="prefetch" href="/Blog-VuePress/assets/js/13.070ff759.js"><link rel="prefetch" href="/Blog-VuePress/assets/js/14.0e20825c.js"><link rel="prefetch" href="/Blog-VuePress/assets/js/15.174517a0.js"><link rel="prefetch" href="/Blog-VuePress/assets/js/16.b3ee9f81.js"><link rel="prefetch" href="/Blog-VuePress/assets/js/17.3bea6bc1.js"><link rel="prefetch" href="/Blog-VuePress/assets/js/18.ef6822c3.js"><link rel="prefetch" href="/Blog-VuePress/assets/js/20.430cba47.js"><link rel="prefetch" href="/Blog-VuePress/assets/js/21.83912b38.js"><link rel="prefetch" href="/Blog-VuePress/assets/js/22.8b34e206.js"><link rel="prefetch" href="/Blog-VuePress/assets/js/23.cc171b6e.js"><link rel="prefetch" href="/Blog-VuePress/assets/js/24.3dfbbff6.js"><link rel="prefetch" href="/Blog-VuePress/assets/js/25.47b6bb09.js"><link rel="prefetch" href="/Blog-VuePress/assets/js/3.402a9049.js"><link rel="prefetch" href="/Blog-VuePress/assets/js/4.4a410761.js"><link rel="prefetch" href="/Blog-VuePress/assets/js/5.668d290d.js"><link rel="prefetch" href="/Blog-VuePress/assets/js/6.2531a79c.js"><link rel="prefetch" href="/Blog-VuePress/assets/js/7.c74fa604.js"><link rel="prefetch" href="/Blog-VuePress/assets/js/8.a2331634.js"><link rel="prefetch" href="/Blog-VuePress/assets/js/9.ef568269.js">
    <link rel="stylesheet" href="/Blog-VuePress/assets/css/0.styles.85a63941.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/Blog-VuePress/" class="home-link router-link-active"><!----> <span class="site-name">dale's blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"> <a href="https://github.com/dalewang1995/Blog-VuePress" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/dalewang1995/Blog-VuePress" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Project</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Blog-VuePress/project/cookie.html" class="active sidebar-link">cookie 你咋还没整明白？</a></li><li><a href="/Blog-VuePress/project/canvas-image-compression.html" class="sidebar-link">Canvas 图片压缩</a></li><li><a href="/Blog-VuePress/project/H5-msg-tel.html" class="sidebar-link">H5 短信、电话</a></li><li><a href="/Blog-VuePress/project/H5-return-btn.html" class="sidebar-link">使用h5新特性 监听返回键</a></li><li><a href="/Blog-VuePress/project/input-autofill.html" class="sidebar-link">Input autocomplete</a></li><li><a href="/Blog-VuePress/project/UI-mp.html" class="sidebar-link">UI 实现需要关注的细节-小程序版</a></li><li><a href="/Blog-VuePress/project/css-animation.html" class="sidebar-link">css动画总结</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>JS</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Server</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>VUE</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>效率工具</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>随笔</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h3 id="cookie-你咋还没整明白？"><a href="#cookie-你咋还没整明白？" class="header-anchor">#</a> cookie 你咋还没整明白？</h3> <h4 id="_1-cookie-比较重要的属性"><a href="#_1-cookie-比较重要的属性" class="header-anchor">#</a> 1. cookie 比较重要的属性</h4> <h5 id="过期时间（expires）"><a href="#过期时间（expires）" class="header-anchor">#</a> 过期时间（expires）</h5> <p><code>expires</code>的值是一个时间点（cookie失效时刻= expires）</p> <p><code>Expires</code> 为 Cookie 的删除设置一个5分钟的过期的日期</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> d <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
d<span class="token punctuation">.</span><span class="token function">setTime</span><span class="token punctuation">(</span>d<span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">5</span><span class="token operator">*</span><span class="token number">60</span><span class="token operator">*</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// in milliseconds</span>
document<span class="token punctuation">.</span>cookie <span class="token operator">=</span> <span class="token string">'foo=bar;path=/;expires='</span><span class="token operator">+</span>d<span class="token punctuation">.</span><span class="token function">toGMTString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">';'</span><span class="token punctuation">;</span>
<span class="token comment">// GMT 格式的时间</span>
</code></pre></div><h5 id="存活时间（max-age）"><a href="#存活时间（max-age）" class="header-anchor">#</a> 存活时间（max-age）</h5> <p><code>max-age</code> 的值是一个以秒为单位时间段（cookie失效时刻= 创建时刻+ max-age）</p> <p><code>max-age</code> 的默认值是 -1(即有效期为 session )；若max-age有三种可能值：负数、0、正数。负数：有效期session；0：删除cookie；正数：有效期为创建时刻+ max-age</p> <p><code>Max-age</code> 设置一个 Cookie 将要过期的秒数</p> <div class="language-js extra-class"><pre class="language-js"><code>document<span class="token punctuation">.</span>cookie <span class="token operator">=</span> <span class="token string">'foo=bar;path=/;max-age='</span><span class="token operator">+</span><span class="token number">5</span><span class="token operator">*</span><span class="token number">60</span><span class="token operator">+</span><span class="token string">';'</span><span class="token punctuation">;</span>
</code></pre></div><h5 id="为什么有的过期时间是1969-？"><a href="#为什么有的过期时间是1969-？" class="header-anchor">#</a> 为什么有的过期时间是1969 ？</h5> <blockquote><p>1969-12-31T23:59:59.000Z</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token string">'1969-12-31T23:59:59.000Z'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">// -1000</span>
</code></pre></div><p>根据测试的4款浏览器这种cookie的过期时间显示如下：</p> <ul><li>FireFox：会话</li> <li>Safair：会话</li> <li>Chrome：1969-12-31T23:59:59.000Z</li> <li>Opera：1969-12-31T23:59:59.000Z</li></ul> <p>这个cookie称为 Session Cookie ，将会一直存在直到关闭浏览器，（在不设置过期时间的情况下，这个是默认值）</p> <h5 id="问：我应该设置哪个？"><a href="#问：我应该设置哪个？" class="header-anchor">#</a> 问：我应该设置哪个？</h5> <p>答：<code>expires</code>，浏览器实现比较好，所有浏览器会正确使用它来保存 Cookie，只需要记得像上边示例那样设置它的 GMT 时间就行了。</p> <h5 id="domain-选项"><a href="#domain-选项" class="header-anchor">#</a> domain 选项</h5> <p>指定了 cookie 将要被发送至哪个或哪些域中。默认情况下，domain 会被设置为创建该 cookie 的页面所在的域名，所以当给相同域名发送请求时该 cookie 会被发送至服务器。例如，</p> <p>设置 .tujia.com</p> <ul><li>fvt.tujia.com</li> <li>www.tujia.com</li> <li>m.tujia.com</li> <li>....tujia.com
都可以使用</li></ul> <p>但是设置了 .fvt.tujia.com</p> <ul><li>tujia.com</li> <li>ddd.tujia.com
不可以使用</li></ul> <p>可以使用下面的语句在浏览器中尝试</p> <div class="language-js extra-class"><pre class="language-js"><code>document<span class="token punctuation">.</span>cookie <span class="token operator">=</span> <span class="token string">&quot;example=2; expires=Mon, 11 Nov 2026 07:34:46 GMT; domain=test.com;path=/&quot;</span>
<span class="token string">&quot;example=2; expires=Mon, 11 Nov 2020 07:34:46 GMT; domain=test.com;path=/&quot;</span>
</code></pre></div><p>关于cookie域的详细讨论：<a href="https://stackoverflow.com/questions/1062963/how-do-browser-cookie-domains-work" target="_blank" rel="noopener noreferrer">这里stackoverflow<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h5 id="path"><a href="#path" class="header-anchor">#</a> path</h5> <p>path 选项值会与 /test，/test2 等等相匹配；任何以 /test 开头的选项都是合法的。需要注意的是，只有在 domain 选项核实完毕之后才会对 path 属性进行比较。path 属性的默认值是发送 Set-Cookie 消息头所对应的 URL 中的 path 部分</p> <p>所以<code>domain</code>和<code>path</code>2个选项共同决定了cookie何时被浏览器自动添加到请求头部中发送出去。如果没有设置这两个选项，则会使用默认值。domain的默认值为设置该cookie的网页所在的域名，path默认值为设置该cookie的网页所在的目录。</p> <h5 id="http-only-cookies"><a href="#http-only-cookies" class="header-anchor">#</a> HTTP-Only cookies</h5> <p>一般来说，只有服务器操作Cookie 才能保证一些必要的安全。但有时候，可能需要前端来增删改查 Cookie, 这个时候咱们的主角出现了——HttpOnly</p> <p><code>documen.coookie</code> 不能读取到 当然也不能设置和更改</p> <h4 id="_2-session-是啥？"><a href="#_2-session-是啥？" class="header-anchor">#</a> 2.session 是啥？</h4> <p>session 的概念 ？</p> <p>一个会话状态，不是实际存在的东西</p> <p>session 的实现 ？</p> <p>Session是在服务端保存的一个数据结构，用来跟踪用户的状态，这个数据可以保存在集群、数据库、文件中；</p> <p>session id 存在前端浏览器的cookie 中，比如常说、的token</p> <p>...</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/dalewang1995/Blog-VuePress/edit/master/docs/project/cookie.md" target="_blank" rel="noopener noreferrer">帮助我改进页面内容！</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">最后更新时间:</span> <span class="time">10/27/2019, 9:06:08 PM</span></div></footer> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/Blog-VuePress/project/canvas-image-compression.html">Canvas 图片压缩</a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/Blog-VuePress/assets/js/app.5bdb8c72.js" defer></script><script src="/Blog-VuePress/assets/js/2.36c4ad05.js" defer></script><script src="/Blog-VuePress/assets/js/19.9bdddd99.js" defer></script>
  </body>
</html>
